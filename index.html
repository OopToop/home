<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OopToop - Home</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    margin: 0;
    padding: 20px;
    color: #333;
  }

  /* Card Container */
  .video-card {
    background: #ffffff;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }

  /* Media */
  .video-thumb {
    width: 100%;
    aspect-ratio: 16 / 9;
    object-fit: cover;
    border-radius: 6px;
    cursor: pointer;
    display: block;
  }


  /* Typography */
  .video-title {
    display: block;
    margin-top: 8px;
    margin-bottom: 5px;
    font-weight: bold;
    font-size: 18px;
  }

  .video-description {
    font-size: 14px;
    color: #555;
    margin-bottom: 10px;
  }

  #video-feed {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 20px;
  }

  /* Links */
  a {
    text-decoration: none;
    color: inherit;
  }
</style>
</head>
<body>
<div class="topbar">
  <a href="index.html" class="logo">
    OopToop
  </a>
</div>

<div id="video-feed"></div>

<script>
const owner = 'OopToop';
const repo = 'videos';
const metadataPath = 'metadata';
const videoFeed = document.getElementById('video-feed');

// fetch all JSON files from metadata folder using GitHub API
fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${metadataPath}`)
    .then(res => res.json())
    .then(files => {
        const jsonFiles = files.filter(f => f.name.endsWith('.json'));

        const fetchPromises = jsonFiles.map(file => fetch(file.download_url).then(r => r.json()));

        Promise.all(fetchPromises)
            .then(allData => {
                allData.forEach((data, i) => {
                    const card = document.createElement('div');
                    card.className = 'video-card';

                    // thumbnail image
                    const thumb = document.createElement('img');
                    thumb.src = `https://raw.githubusercontent.com/OopToop/videos/main/thumbnails/${encodeURIComponent(data.thumbnail)}`;
                    thumb.alt = data.title;
                    thumb.className = 'video-thumb';

                    // title link
                    const titleLink = document.createElement('a');
                    titleLink.className = 'video-title';
                    titleLink.textContent = data.title || 'Untitled';
                    titleLink.href = `video.html?id=${encodeURIComponent(jsonFiles[i].name)}`;

                    // make thumbnail clickable too
                    thumb.addEventListener('click', () => {
                        window.location.href = titleLink.href;
                    });

                    card.appendChild(thumb);
                    card.appendChild(titleLink);

                    videoFeed.appendChild(card);
                });
            })
            .catch(err => console.error('Error loading metadata JSONs:', err));
    })
    .catch(err => console.error('Error fetching metadata folder:', err));
</script>
</body>
</html>
